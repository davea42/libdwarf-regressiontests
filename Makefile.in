# Makefile which builds builds the code to test and
# runs the executables.
# Running these tests multiple times simultaneously
# in a single directory will result in incorrect 
# results and errors.
# We use BASEFILES to give tests the needed context.

buildwithlibelf = @withlibelf@
testsrc = @srcdir@
all:  pretest build testonly

test: pretest build testonly

build: pretest
	sh $(testsrc)/PICKUPBIN $(buildwithlibelf) 

check: pretest testonly
testonly:
	sh $(testsrc)/RUNALL.sh $(buildwithlibelf)
pretest:
	sh $(testsrc)/CHECKIFRUNNING.sh
# RUNALL.sh does this
dd:
	$(testsrc)/DWARFTEST.sh $(buildwithlibelf)  2>ALLdd 1>&2
clean:
	sh $(testsrc)/CLEANUP 
distclean: clean
	rm -f Makefile
	rm -f config.h
	rm -f config.status
	rm -f config.status
	rm -f config.log
	rm -fr autom4te.cache
	rm -f dwarfdump.O
	rm -f dwarfdump2.O
